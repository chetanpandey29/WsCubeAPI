--GETMAILLIST_1.0
DECLARE @QRY VARCHAR(512)
SET @QRY = ''
SET @QRY = 'SELECT SCHEDULEID,SCHEDULENAME [Email Option Name],CASE WHEN [STATUS]= 1 THEN ''LBLACTIVE'' WHEN [STATUS] = 0 THEN ''LBLINACTIVE'' WHEN STATUS=3 THEN ''Default'' END [STATUS]
FROM SCHEDULE WHERE SCHEDULETYPEID NOT IN (9,10,12,13,14,15,16,17) '
+ CASE WHEN ISNULL(@SCHEDULETYPEID,'')='' THEN '' ELSE ' AND SCHEDULETYPEID IN ('+@SCHEDULETYPEID+')' END
+ CASE WHEN ISNULL(@STATUS,'')='' THEN ' AND STATUS != 2 ' ELSE ' AND STATUS IN ('+@STATUS+')' END
+' ORDER BY SCHEDULENAME ASC'
EXEC( @QRY)
SELECT COUNT(SCHEDULETYPEID) FROM SCHEDULETYPES WHERE STATUS=1
AND SCHEDULETYPENAME NOT IN ('Reports') AND SCHEDULETYPEID NOT IN(5,6,11,13,14,15,16,17)