IF EXISTS(SELECT 1 FROM USERINFO UR INNER JOIN ROLES R ON R.ROLEID = UR.DEFAULTROLEID AND R.STATUS = 1 AND R.ALLSITES = 1 WHERE UR.USERID = @USERID)
SELECT SITEID,SITENAME FROM SITES WHERE STATUS=1 ORDER BY SITENAME
ELSE
SELECT DISTINCT S.SITEID,S.SITENAME FROM SITES S INNER JOIN USERSITES US ON US.SITEID =S.SITEID WHERE US.USERID=@USERID AND US.STATUS=1 AND S.STATUS=1 ORDER BY SITENAME