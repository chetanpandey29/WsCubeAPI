-- GETMYCORRACTIVEACTION_FILTER_1.0.config

DECLARE @REPORTFILTEROPTIONS TABLE(OPTIONID INT,OPTIONNAME NVARCHAR(256),QUERY VARCHAR(256),REPORTPARAM VARCHAR(256),
FILTERPARAM VARCHAR(MAX),FILTERPARAMMAP VARCHAR(MAX),OPTIONSCATEGORYID INT,DISPLAYORDER INT)

DECLARE @SCHEDULEFILTERS TABLE(ID INT,OPTIONID INT,REPORTPARAM VARCHAR(256),VAL VARCHAR(MAX))
DECLARE @RESULT VARCHAR(MAX)
SET @RESULT =''


INSERT INTO @REPORTFILTEROPTIONS
SELECT DISTINCT M.OPTIONID,M.OPTIONNAME OPTIONNAME,M.WACCESS QUERY,M.REPORTPARAM,M.FILTERPARAM,M.FILTERPARAMMAP,M.OPTIONSCATEGORYID,DISPLAYORDER
FROM REPORTOPTIONSMASTER M
WHERE M.STATUS=1 AND OPTIONSCATEGORYID=1 AND M.OPTIONID IN (1,2,4,53)
UNION ALL
SELECT DISTINCT M.OPTIONID,M.OPTIONNAME OPTIONNAME,M.WACCESS QUERY,M.REPORTPARAM,M.FILTERPARAM,M.FILTERPARAMMAP,M.OPTIONSCATEGORYID,DISPLAYORDER
FROM REPORTOPTIONSMASTER M
WHERE M.STATUS=1 AND OPTIONSCATEGORYID=4 AND M.OPTIONID IN (19,20)
UNION ALL
SELECT DISTINCT M.OPTIONID,M.OPTIONNAME OPTIONNAME,M.WACCESS QUERY,M.REPORTPARAM,M.FILTERPARAM,M.FILTERPARAMMAP,M.OPTIONSCATEGORYID,DISPLAYORDER
FROM REPORTOPTIONSMASTER M
WHERE M.STATUS=1 AND OPTIONSCATEGORYID=5 AND M.OPTIONID IN (15,40,41,43)
UNION ALL
SELECT DISTINCT M.OPTIONID,CASE WHEN M.RELATIONID>0 THEN (SELECT TOP 1 ENTITYVALUE FROM ENTITYTRANSLATION WHERE LANGUAGEID=@LANGUAGEID AND ENTITYTYPE='GRP_TYPE' AND ENTITYID=M.RELATIONID) ELSE M.OPTIONNAME END OPTIONNAME,M.WACCESS QUERY,M.REPORTPARAM,M.FILTERPARAM,M.FILTERPARAMMAP,M.OPTIONSCATEGORYID,DISPLAYORDER
FROM REPORTOPTIONSMASTER M
INNER JOIN GROUPTYPES GT ON GT.GROUPTYPEID=M.RELATIONID
WHERE M.STATUS=1 AND OPTIONSCATEGORYID=2 AND M.OPTIONID BETWEEN 22 AND 31 AND GT.STATUS =1

SELECT * FROM @REPORTFILTEROPTIONS ORDER BY OPTIONSCATEGORYID,DISPLAYORDER

SELECT OPTIONSCATEGORYID,CATEGORYNAME FROM REPORTOPTIONSCATEGORY
WHERE OPTIONSCATEGORYID IN (1,2,4,5)


SELECT 'SITEID:'+CAST(S.SITEID AS NVARCHAR)+'~~!~~'+S.SITENAME RESULT FROM USERINFO UI
INNER JOIN SITES S ON S.SITEID = UI.DEFAULTSITEID
WHERE UI.USERID =@USERID
