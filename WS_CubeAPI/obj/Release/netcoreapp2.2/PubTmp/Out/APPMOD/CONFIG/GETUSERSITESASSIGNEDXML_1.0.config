--GETUSERSITESASSIGNED_1.0
IF @USERID=0
BEGIN

SELECT '<option value="'+CAST(SITEID AS VARCHAR(32))+'">'+SITENAME+'</option>' AS 'data()' FROM SITES WHERE SITEID IN(SELECT DEFAULTSITEID FROM USERINFO WHERE USERID=@LOGGEDUSERID) AND STATUS=1 FOR XML PATH('')  ;
END
ELSE
BEGIN

SELECT '<option value="'+CAST(SITEID AS VARCHAR(32))+'">'+SITENAME+CASE WHEN STATUS = 0 THEN '( InActive )' ELSE '' END+'</option>' AS 'data()' FROM SITES WHERE SITEID IN(SELECT SITEID FROM USERSITES WHERE USERID=@USERID AND STATUS=1) AND STATUS!=2 ORDER BY SITENAME ASC FOR XML PATH('')  ;
END