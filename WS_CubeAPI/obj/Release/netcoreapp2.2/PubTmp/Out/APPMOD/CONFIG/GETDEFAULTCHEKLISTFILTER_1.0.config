--GETDEFAULTCHEKLISTFILTER_1.0
DECLARE @OBSLISTINGXMONTHS INT,@UTCDATE DATETIME,@DURATION INT

SELECT @DURATION=DURATION FROM TIMEZONES WHERE TIMEZONEID IN (SELECT TIMEZONE FROM USERINFO WHERE USERID=@USERID)
SELECT @UTCDATE=DATEADD(MI,@DURATION,GETUTCDATE())--DBO.USERTIMEEMAIL(GETUTCDATE(),1,@DURATION)

SELECT @OBSLISTINGXMONTHS = ISNULL(OPTIONVALUE,12) FROM COMPANYOPTIONS WHERE OPTIONNAME='OBSLISTINGXMONTHS'

DECLARE @STARTDATE NVARCHAR(32),@ENDDATE NVARCHAR(32)
SELECT @STARTDATE='''',@ENDDATE=''''
SELECT @STARTDATE=CONVERT(NVARCHAR(32),DATEADD(DAY, 1 - DAY(GETDATE()),DATEADD(MONTH,-(@OBSLISTINGXMONTHS), GETDATE())),101),@ENDDATE =CONVERT(NVARCHAR(32),@UTCDATE,101)
SELECT CAST(DEFAULTSITEID AS NVARCHAR(8))+'~~!~~'+(SELECT SITENAME FROM SITES WHERE SITEID=UI.DEFAULTSITEID) SITENAME,@STARTDATE+' - '+@ENDDATE[OBSLISTINGXMONTHSVAL]  FROM USERINFO UI WHERE USERID=@USERID
