--DELETEAREA_1.0
DECLARE @CC_TIMESTAMP DATETIME
SET @CC_TIMESTAMP=GETDATE()

UPDATE AREAS SET STATUS=2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE AREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@AREAID))
UPDATE [STOPCARDENTRYATTACHMENTS] SET STATUS = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT CARDID FROM STOPCARDENTRY WHERE AREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@AREAID)))
UPDATE [STOPCARDENTRYOBSERVATIONS] SET STATUS = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT CARDID FROM STOPCARDENTRY WHERE AREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@AREAID)))
UPDATE STOPCARDENTRYOBSERVERS SET STATUS = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT CARDID FROM STOPCARDENTRY WHERE AREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@AREAID)))
UPDATE STOPCARDENTRY SET [STATUS] = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE AREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@AREAID));

--OL TABLES
UPDATE [STOPCARDENTRYATTACHMENTS_OL] SET STATUS = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT CARDID FROM STOPCARDENTRY_OL WHERE AREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@AREAID)))
UPDATE [STOPCARDENTRYOBSERVATIONS_OL] SET STATUS = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT CARDID FROM STOPCARDENTRY_OL WHERE AREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@AREAID)))
UPDATE STOPCARDENTRYOBSERVERS_OL SET STATUS = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT CARDID FROM STOPCARDENTRY_OL WHERE AREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@AREAID)))
UPDATE STOPCARDENTRY_OL SET [STATUS] = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE AREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@AREAID));


--SCHEDULEREPORTS
DELETE FROM SCHEDULEASSIGNMENTS WHERE OPTIONID=2 AND OPTIONVALUE IN (SELECT RESULT FROM DBO.CSVTOTABLE(@AREAID))
DELETE FROM REPORTFILTER WHERE OPTIONID=2 AND FILTERVALUE IN (SELECT RESULT FROM DBO.CSVTOTABLE(@AREAID))


INSERT INTO dbo.AUDIT(TABLENAME,TRANS,STAMP,LASTUPDATEDBY,DATA)
SELECT 'AREAS/[STOPCARDENTRYATTACHMENTS]/[STOPCARDENTRYOBSERVATIONS]/STOPCARDENTRYOBSERVERS/STOPCARDENTRY','UPDATE-DELETEAREA_1.0',@CC_TIMESTAMP,@USERID,NULL
