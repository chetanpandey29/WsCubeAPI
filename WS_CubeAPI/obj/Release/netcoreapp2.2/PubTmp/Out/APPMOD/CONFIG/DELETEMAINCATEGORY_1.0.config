--DELETEMAINCATEGORY_1.0
DECLARE @CC_TIMESTAMP DATETIME
SET @CC_TIMESTAMP=GETDATE()

DELETE FROM [CHECKLISTSETUPCATEGORYASSIGNMENTS]  WHERE  MAINCATEGORYID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@MAINCATEGORYID))

UPDATE [CORRECTIVEACTIONSCATEGORY] SET STATUS = 2,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP WHERE  MAINCATEGORYID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@MAINCATEGORYID))

UPDATE [STOPCARDENTRYOBSERVATIONS] SET STATUS = 2,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP WHERE  MAINCATEGORYID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@MAINCATEGORYID))

UPDATE [STOPCARDENTRYATTACHMENTS] SET STATUS = 2,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP WHERE  MAINCATEGORYID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@MAINCATEGORYID))
--OL
UPDATE [STOPCARDENTRYOBSERVATIONS_OL] SET STATUS = 2,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP WHERE  MAINCATEGORYID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@MAINCATEGORYID))

UPDATE [STOPCARDENTRYATTACHMENTS_OL] SET STATUS = 2,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP WHERE  MAINCATEGORYID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@MAINCATEGORYID))


UPDATE [MAINCATEGORIES] SET STATUS = 2,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP WHERE  MAINCATEGORYID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@MAINCATEGORYID))

UPDATE [SUBCATEGORIES] SET STATUS = 2,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP WHERE  MAINCATEGORYID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@MAINCATEGORYID))

UPDATE [REDFLAGS] SET STATUS = 2,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP WHERE  MAINCATEGORYID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@MAINCATEGORYID))

UPDATE ENTITYTRANSLATION SET STATUS = 2,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP WHERE  PARENTID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@MAINCATEGORYID)) AND ENTITYTYPE='MAIN_CTG'

SELECT 1

INSERT INTO dbo.AUDIT(TABLENAME,TRANS,STAMP,LASTUPDATEDBY,DATA)
SELECT 'CHECKLISTSETUPCATEGORYASSIGNMENTS/CORRECTIVEACTIONSCATEGORY/STOPCARDENTRYOBSERVATIONS/STOPCARDENTRYATTACHMENTS/MAINCATEGORIES/SUBCATEGORIES/REDFLAGS/ENTITYTRANSLATION','DELETE-DELETEMAINCATEGORY_1.0',@CC_TIMESTAMP,@UPDATEDBY,NULL
