SELECT DISTINCT CS.MAINCATEGORYID,ENTITYVALUE FROM CHECKLISTSETUPCATEGORYASSIGNMENTS CS
INNER JOIN ENTITYTRANSLATION ET ON ET.PARENTID = CS.MAINCATEGORYID AND ET.ENTITYTYPE='MAIN_CTG' AND ET.LANGUAGEID=@LANGUAGEID
INNER JOIN MAINCATEGORIES M ON M.MAINCATEGORYID=CS.MAINCATEGORYID
WHERE CHECKLISTSETUPID=@CHECKLISTSETUPID AND MAINISASSIGNED=1
AND EXISTS (SELECT 1 FROM SUBCATEGORIES WHERE STATUS=1 AND MAINCATEGORYID=CS.MAINCATEGORYID) AND M.STATUS=1
ORDER BY ENTITYVALUE