DECLARE @CC_TIMESTAMP DATETIME
SET @CC_TIMESTAMP=GETDATE()

IF EXISTS ( SELECT 1 FROM SHIFTS WHERE SHIFTNAME=@SHIFTNAME AND SHIFTID!=@SHIFTID AND STATUS!=2)
BEGIN
SELECT '-1'
END
ELSE
BEGIN
UPDATE SHIFTS SET SHIFTNAME=@SHIFTNAME,STATUS=@STATUS,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP
WHERE SHIFTID=@SHIFTID;
SELECT @SHIFTID
END


INSERT INTO dbo.AUDIT(TABLENAME,TRANS,STAMP,LASTUPDATEDBY,DATA)
SELECT 'SHIFTS','UPDATE-UPDATESHIFTGENERALINFO_1.0',@CC_TIMESTAMP,@UPDATEDBY,NULL
