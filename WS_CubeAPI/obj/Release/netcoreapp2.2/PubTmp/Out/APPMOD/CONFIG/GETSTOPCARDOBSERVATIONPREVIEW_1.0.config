SELECT MAINCATEGORYID,[MAINCATEGORYNAME],ALLSAFECHECK FROM(
SELECT DISTINCT CSC.MAINCATEGORYID,ET.ENTITYVALUE [MAINCATEGORYNAME],CS.ALLSAFECHECK,CSC.MAINSEQUENCE
FROM CHECKLISTSETUP CS
INNER JOIN CHECKLISTSETUPCATEGORYASSIGNMENTS CSC ON CS.CHECKLISTSETUPID=CSC.CHECKLISTSETUPID
INNER JOIN MAINCATEGORIES M ON M.MAINCATEGORYID=CSC.MAINCATEGORYID
INNER JOIN SUBCATEGORIES S ON S.MAINCATEGORYID=CSC.MAINCATEGORYID AND S.SUBCATEGORYID=CSC.SUBCATEGORYID
INNER JOIN ENTITYTRANSLATION ET ON ET.ENTITYID = CSC.MAINCATEGORYID AND ET.ENTITYTYPE='MAIN_CTG' AND ET.LANGUAGEID =@LANGUAGEID
WHERE M.STATUS =1 AND CS.STATUS != 2 AND CSC.MAINISASSIGNED = 1 AND CSC.SUBISASSIGNED = 1 AND S.STATUS = 1
AND CS.CHECKLISTSETUPID=@CHECKLISTSETUPID AND CS.CATEGORYTYPE=1) A ORDER BY MAINSEQUENCE

SELECT CHECKLISTSETUPID,MAINCATEGORYID,SUBCATEGORYID,SUBSEQUENCE,[SUBCATEGORYNAME],ALLSAFECHECK FROM
(SELECT DISTINCT CS.CHECKLISTSETUPID,CSC.MAINCATEGORYID,CSC.SUBCATEGORYID,CSC.SUBSEQUENCE,ET.ENTITYVALUE [SUBCATEGORYNAME],CS.ALLSAFECHECK,CSC.MAINSEQUENCE
FROM CHECKLISTSETUP CS
INNER JOIN CHECKLISTSETUPCATEGORYASSIGNMENTS CSC ON CS.CHECKLISTSETUPID=CSC.CHECKLISTSETUPID
INNER JOIN SUBCATEGORIES S ON S.MAINCATEGORYID=CSC.MAINCATEGORYID AND S.SUBCATEGORYID=CSC.SUBCATEGORYID
INNER JOIN ENTITYTRANSLATION ET ON ET.PARENTID=CSC.MAINCATEGORYID AND ET.ENTITYID = CSC.SUBCATEGORYID AND ET.ENTITYTYPE='SUB_CTG' AND ET.LANGUAGEID =@LANGUAGEID
WHERE S.STATUS=1 AND CS.STATUS != 2 AND CSC.MAINISASSIGNED = 1 AND CSC.SUBISASSIGNED = 1
AND CS.CHECKLISTSETUPID=@CHECKLISTSETUPID AND CS.CATEGORYTYPE=1)A ORDER BY MAINSEQUENCE,SUBSEQUENCE
