SELECT LANGUAGEID,LANGUAGENAME FROM LANGUAGES WHERE [STATUS]=1 ORDER BY LANGUAGENAME;
IF EXISTS(SELECT 1 FROM USERINFO UR INNER JOIN ROLES R ON R.ROLEID = UR.DEFAULTROLEID AND R.STATUS = 1 AND R.ALLSITES = 1 WHERE UR.USERID = @USERID)
SELECT SITEID,SITENAME FROM SITES WHERE STATUS=1 ORDER BY SITENAME
ELSE
SELECT DISTINCT S.SITEID,S.SITENAME FROM SITES S INNER JOIN USERSITES US ON US.SITEID =S.SITEID WHERE US.USERID=@USERID AND US.STATUS=1 AND S.STATUS=1 ORDER BY SITENAME;
SELECT TIMEZONEID,TIMEZONENAME FROM TIMEZONES WHERE STATUS = 1 ORDER BY TIMEZONENAME;
SELECT U.USERNAME,DBO.fn40Decrypt(U.PASSWORD) PASSWORD,
DBO.fn40Decrypt(U.PASSWORD) CONFIRMPASSWORD,
U.LASTNAME,U.FIRSTNAME,U.EMAIL,UI.DATEFORMAT,
UI.LANGUAGEID,UI.DEFAULTSITEID,UI.TIMEZONE,
UI.DEFAULTROLEID
FROM USERS U
INNER JOIN USERINFO UI ON UI.USERID = U.USERID
WHERE U.USERID = @USERID;

SELECT (SELECT LANGUAGEID FROM LANGUAGES L
INNER JOIN COMPANYOPTIONS CO ON CO.OPTIONVALUE=L.INTERNALNAME AND CO.OPTIONNAME='Languages')LANGUAGEID,

(SELECT OPTIONVALUE FROM COMPANYOPTIONS WHERE OPTIONNAME='DefaultDateFormat')DATEFORMAT,

(SELECT TIMEZONEID FROM TIMEZONES L
INNER JOIN COMPANYOPTIONS CO ON CO.OPTIONVALUE=L.TIMEZONEID AND CO.OPTIONNAME='Timezone')TIMEZONE,

(SELECT OPTIONVALUE FROM COMPANYOPTIONS WHERE OPTIONNAME='PasswordComplexity')PWDCOMPLEXITY,

(SELECT OPTIONVALUE FROM COMPANYOPTIONS WHERE OPTIONNAME='PasswordMinNumericalChar')PWDNUMERIC,

(SELECT OPTIONVALUE FROM COMPANYOPTIONS WHERE OPTIONNAME='PasswordMinAlphaChar')PWDALPHA,

(SELECT OPTIONVALUE FROM COMPANYOPTIONS WHERE OPTIONNAME='PasswordMinSpecialChar')PWDSPECCHAR,

(SELECT OPTIONVALUE FROM COMPANYOPTIONS WHERE OPTIONNAME='UserNameMinLength')USERNAMELEN,

(SELECT OPTIONVALUE FROM COMPANYOPTIONS WHERE OPTIONNAME='PasswordMinLength')PWDLEN

