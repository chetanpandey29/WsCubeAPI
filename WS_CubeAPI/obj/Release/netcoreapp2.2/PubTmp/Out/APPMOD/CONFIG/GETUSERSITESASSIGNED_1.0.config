IF @USERID=0
BEGIN
SELECT SITEID,SITENAME FROM SITES WHERE SITEID IN(SELECT DEFAULTSITEID FROM USERINFO WHERE USERID=@LOGGEDUSERID) AND STATUS=1
END
ELSE
BEGIN
SELECT SITEID,SITENAME+CASE WHEN STATUS = 0 THEN '( InActive )' ELSE '' END SITENAME FROM SITES WHERE SITEID IN(SELECT SITEID FROM USERSITES WHERE USERID=@USERID AND STATUS=1) AND STATUS!=2 ORDER BY SITENAME ASC
END