DECLARE @CC_TIMESTAMP DATETIME
SET @CC_TIMESTAMP=GETDATE()
IF @OBSAPPROVALPC=0
BEGIN
UPDATE [STOPCARDENTRY] SET STATUS = CASE WHEN STATUS = 1 THEN 0 WHEN STATUS = 0 THEN 1 END,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@CARDID))
UPDATE [STOPCARDENTRYATTACHMENTS] SET STATUS = CASE WHEN STATUS = 1 THEN 0 WHEN STATUS = 0 THEN 1 END,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@CARDID))
END
ELSE
BEGIN
UPDATE [STOPCARDENTRY_OL] SET STATUS = CASE WHEN STATUS = 1 THEN 0 WHEN STATUS = 0 THEN 1 END,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@CARDID))
UPDATE [STOPCARDENTRYATTACHMENTS_OL] SET STATUS = CASE WHEN STATUS = 1 THEN 0 WHEN STATUS = 0 THEN 1 END,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@CARDID))

END
SELECT 1

INSERT INTO dbo.AUDIT(TABLENAME,TRANS,STAMP,LASTUPDATEDBY,DATA)
SELECT 'STOPCARDENTRY/STOPCARDENTRYATTACHMENTS/STOPCARDENTRY_OL/STOPCARDENTRYATTACHMENTS_OL','UPDATE-UPDATESTATUSSTOPCARD_1.0',@CC_TIMESTAMP,@UPDATEDBY,NULL

