IF @ROLEID=1
BEGIN
SELECT SITEID,SITENAME FROM SITES WHERE STATUS = 1
ORDER BY SITENAME
END
ELSE
BEGIN
SELECT DISTINCT S.SITEID,S.SITENAME FROM SITES S
INNER JOIN USERSITES US ON US.SITEID = S.SITEID AND US.USERID = @USERID
WHERE S.STATUS = 1 AND US.STATUS = 1
ORDER BY SITENAME
END
