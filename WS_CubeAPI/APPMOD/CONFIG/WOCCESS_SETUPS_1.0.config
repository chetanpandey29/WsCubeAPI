IF ISNULL(@SITEID,'')=''
BEGIN
IF @ROLEID=1
SELECT DISTINCT CHECKLISTSETUPID,SETUPNAME  FROM CHECKLISTSETUP WHERE STATUS<>2
ORDER BY SETUPNAME

ELSE
SELECT DISTINCT CS.CHECKLISTSETUPID,CS.SETUPNAME  FROM CHECKLISTSETUP CS
INNER JOIN CHECKLISTSETUPSITES CSS ON CSS.CHECKLISTSETUPID=CS.CHECKLISTSETUPID
INNER JOIN USERSITES US ON US.SITEID = CSS.SITEID AND US.USERID = @USERID
WHERE CS.STATUS=1 AND US.STATUS = 1
END
ELSE
SELECT DISTINCT CS.CHECKLISTSETUPID,CS.SETUPNAME  FROM CHECKLISTSETUP CS
INNER JOIN CHECKLISTSETUPSITES CSS ON CSS.CHECKLISTSETUPID=CS.CHECKLISTSETUPID
INNER JOIN DBO.CSVtoTable(@SITEID) S ON S.RESULT=CSS.SITEID
WHERE CS.STATUS=1
