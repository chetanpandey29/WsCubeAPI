SELECT DISTINCT G.GROUPTYPEID,G.GROUPID,
(SELECT DISTINCT ENTITYVALUE FROM ENTITYTRANSLATION WHERE LANGUAGEID = @LANGUAGEID AND PARENTID = G.GROUPTYPEID AND ENTITYID =G.GROUPID AND ENTITYTYPE='UGP_TYPE')
+CASE WHEN G.STATUS=0 THEN ' (Inactive) ' ELSE '' END GROUPNAME,
CASE WHEN UG.USERID IS NULL THEN 0 WHEN UG.USERID IS NOT NULL THEN 1 END FLAG
FROM GROUPS G
INNER JOIN USERGROUPS UG ON UG.GROUPID = G.GROUPID AND UG.GROUPTYPEID = G.GROUPTYPEID AND UG.USERID = @USERID AND UG.STATUS=1
WHERE G.STATUS<>2
UNION ALL
SELECT DISTINCT G.GROUPTYPEID,G.GROUPID,
ISNULL((SELECT DISTINCT ENTITYVALUE FROM ENTITYTRANSLATION WHERE LANGUAGEID = @LANGUAGEID AND PARENTID = G.GROUPTYPEID AND ENTITYID =G.GROUPID AND ENTITYTYPE='UGP_TYPE'),G.GROUPNAME) GROUPNAME,
0 FLAG
FROM GROUPS G
WHERE G.STATUS=1 AND GROUPID NOT IN (SELECT GROUPID FROM USERGROUPS WHERE STATUS =1 AND USERID =@USERID)