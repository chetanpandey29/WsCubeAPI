DECLARE @CC_TIMESTAMP DATETIME
SET @CC_TIMESTAMP=GETDATE()

IF LEN(@SELGROUPTYPEID)>0
BEGIN
UPDATE GROUPTYPES SET ISMANDATORY=0,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP
UPDATE GROUPTYPES SET ISMANDATORY=1,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP WHERE GROUPTYPEID IN(SELECT RESULT FROM DBO.CSVTOTABLE(@SELGROUPTYPEID))
END
ELSE
BEGIN
UPDATE GROUPTYPES SET ISMANDATORY=0,UPDATEDBY=@UPDATEDBY,UPDATEDDATE=@CC_TIMESTAMP
END
SELECT 2

INSERT INTO dbo.AUDIT(TABLENAME,TRANS,STAMP,LASTUPDATEDBY,DATA)
SELECT 'GROUPTYPES','UPDATE-UPDATEGROUPTYPES_1.0',@CC_TIMESTAMP,@UPDATEDBY,
(SELECT * FROM GROUPTYPES WHERE UPDATEDBY=@UPDATEDBY AND UPDATEDDATE=@CC_TIMESTAMP FOR XML AUTO)
