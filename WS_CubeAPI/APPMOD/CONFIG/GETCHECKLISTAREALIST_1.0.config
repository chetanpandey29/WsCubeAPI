--GETCHECKLISTAREALIST_1.0
IF @MODE=0
SELECT AREAID,AREANAME FROM AREAS WHERE AREAID
IN(SELECT AREAID FROM SITEAREAS WHERE SITEID=@SITEID AND STATUS=1) AND STATUS=1 ORDER BY AREANAME
ELSE
BEGIN
IF @OBSAPPROVALPC=0
SELECT AREAID,AREANAME FROM
(SELECT AREAID,AREANAME +CASE WHEN STATUS=0 THEN '( InActive )' WHEN EXISTS(SELECT 1 FROM SITEAREAS WHERE SITEID=@SITEID AND AREAID=A.AREAID AND STATUS=0) THEN ' ( Unassigned )' ELSE '' END AREANAME FROM AREAS A WHERE AREAID IN (SELECT AREAID FROM STOPCARDENTRY WHERE CARDID=@CARDID AND SITEID =@SITEID)
UNION
SELECT A.AREAID,A.AREANAME FROM AREAS A
INNER JOIN SITEAREAS SA ON SA.SITEID=@SITEID AND SA.AREAID=A.AREAID AND SA.STATUS=1
WHERE A.STATUS = 1 AND A.AREAID NOT IN (SELECT AREAID FROM STOPCARDENTRY WHERE CARDID=@CARDID AND SITEID =@SITEID)) A
ORDER BY AREANAME
ELSE IF @OBSAPPROVALPC=1
SELECT AREAID,AREANAME FROM
(SELECT AREAID,AREANAME +CASE WHEN STATUS=0 THEN '( InActive )' WHEN EXISTS(SELECT 1 FROM SITEAREAS WHERE SITEID=@SITEID AND AREAID=A.AREAID AND STATUS=0) THEN ' ( Unassigned )' ELSE '' END AREANAME FROM AREAS A WHERE AREAID IN (SELECT AREAID FROM STOPCARDENTRY_OL WHERE CARDID=@CARDID AND SITEID =@SITEID)
UNION
SELECT A.AREAID,A.AREANAME FROM AREAS A
INNER JOIN SITEAREAS SA ON SA.SITEID=@SITEID AND SA.AREAID=A.AREAID AND SA.STATUS=1
WHERE A.STATUS = 1 AND A.AREAID NOT IN (SELECT AREAID FROM STOPCARDENTRY_OL WHERE CARDID=@CARDID AND SITEID =@SITEID)) A

END