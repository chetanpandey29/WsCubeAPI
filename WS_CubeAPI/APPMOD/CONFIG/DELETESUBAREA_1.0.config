--DELETESUBAREA_1.0
DECLARE @CC_TIMESTAMP DATETIME
SET @CC_TIMESTAMP=GETDATE()

UPDATE SUBAREAS SET STATUS=2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE SUBAREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@SUBAREAID))
UPDATE [STOPCARDENTRYATTACHMENTS] SET STATUS = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT CARDID FROM STOPCARDENTRY WHERE SUBAREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@SUBAREAID)))
UPDATE [STOPCARDENTRYOBSERVATIONS] SET STATUS = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT CARDID FROM STOPCARDENTRY WHERE SUBAREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@SUBAREAID)))
UPDATE STOPCARDENTRYOBSERVERS SET STATUS = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT CARDID FROM STOPCARDENTRY WHERE SUBAREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@SUBAREAID)))
UPDATE STOPCARDENTRY SET [STATUS] = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE SUBAREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@SUBAREAID));

--OL TABLES
UPDATE [STOPCARDENTRYATTACHMENTS_OL] SET STATUS = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT CARDID FROM STOPCARDENTRY_OL WHERE SUBAREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@SUBAREAID)))
UPDATE [STOPCARDENTRYOBSERVATIONS_OL] SET STATUS = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT CARDID FROM STOPCARDENTRY_OL WHERE SUBAREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@SUBAREAID)))
UPDATE STOPCARDENTRYOBSERVERS_OL SET STATUS = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE CARDID IN (SELECT CARDID FROM STOPCARDENTRY_OL WHERE SUBAREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@SUBAREAID)))
UPDATE STOPCARDENTRY_OL SET [STATUS] = 2,UPDATEDBY=@USERID,UPDATEDDATE=@CC_TIMESTAMP WHERE SUBAREAID IN (SELECT RESULT FROM DBO.CSVTOTABLE(@SUBAREAID));

--SCHEDULEREPORTS
DELETE FROM SCHEDULEASSIGNMENTS WHERE OPTIONID=53 AND OPTIONVALUE IN (SELECT RESULT FROM DBO.CSVTOTABLE(@SUBAREAID))
DELETE FROM REPORTFILTER WHERE OPTIONID=53 AND FILTERVALUE IN (SELECT RESULT FROM DBO.CSVTOTABLE(@SUBAREAID))

INSERT INTO dbo.AUDIT(TABLENAME,TRANS,STAMP,LASTUPDATEDBY,DATA)
SELECT 'SUBAREAS/[STOPCARDENTRYATTACHMENTS]/[STOPCARDENTRYOBSERVATIONS]/STOPCARDENTRYOBSERVERS/STOPCARDENTRY','UPDATE-DELETESUBAREA_1.0',@CC_TIMESTAMP,@USERID,NULL


